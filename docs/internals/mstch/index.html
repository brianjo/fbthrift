<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-internals/mstch">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">mstch-based code generators | Facebook Thrift</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.internalfb.com/docs/internals/mstch"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="mstch-based code generators | Facebook Thrift"><meta data-rh="true" name="description" content="* Thrift Generators"><meta data-rh="true" property="og:description" content="* Thrift Generators"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.internalfb.com/docs/internals/mstch"><link data-rh="true" rel="alternate" href="https://www.internalfb.com/docs/internals/mstch" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.internalfb.com/docs/internals/mstch" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.afc07cdd.css">
<link rel="preload" href="/assets/js/runtime~main.1abcbc59.js" as="script">
<link rel="preload" href="/assets/js/main.b3203846.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Facebook Thrift Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Facebook Thrift Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Facebook Thrift</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/fbthrift" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/spec/">Specification</a><button aria-label="Toggle the collapsible sidebar category &#x27;Specification&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/guide/">User Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/experimental/">Experimental Features</a><button aria-label="Toggle the collapsible sidebar category &#x27;Experimental Features&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/beta/">Beta Features</a><button aria-label="Toggle the collapsible sidebar category &#x27;Beta Features&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/cpp/">C++</a><button aria-label="Toggle the collapsible sidebar category &#x27;C++&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/internals/">Internals</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internals&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/internals/function-signatures">Function signatures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/internals/header-format">Header format for the THeader.h</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/internals/mstch">mstch-based code generators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/internals/protocol-structure">Thrift Protocol Structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/internals/stream-classes">Stream classes</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/debugging">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references/">References</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/releases">Releases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/contribution-guide">Contribution Guide</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>mstch-based code generators</h1><ul><li><a href="#thrift-generators">Thrift Generators</a></li><li><a href="#creating-a-generator">Creating a generator</a></li><li><a href="#using-templates">Using Templates</a><ul><li><a href="#writing-the-driver">Writing the driver</a></li><li><a href="#partial-templates">Partial Templates</a></li><li><a href="#context-types">Context types</a></li><li><a href="#context-structure">Context structure</a></li><li><a href="#extending-context-maps">Extending Context Maps</a></li></ul></li><li><a href="#using-the-new-generator">Using the new generator</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="thrift-generators">Thrift Generators<a class="hash-link" href="#thrift-generators" title="Direct link to heading">​</a></h2><p>A Thrift generator is a component of the Thrift compiler whose job it is to
generate code from the Thrift IDL for some particular language. This generated
code is used to implement Thrift clients and servers in the various languages
for which a generator exists.</p><p>This document describes how to create and use generators written using mstch,
a template library used by Thrift to increase maintainability and clarity of
the Thrift generators.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-generator">Creating a generator<a class="hash-link" href="#creating-a-generator" title="Direct link to heading">​</a></h2><p>Each mstch generator is comprised of two components. Firstly, there is a C++
source file which drives template generation, controls output, and integrates
the generator with the rest of the compiler. Secondly, there are mstch template
files which contain the templates to be rendered by the C++ driver.</p><p>Taking the Java Swift generator as an example, the C++ driver is located in
<code>thrift/compiler/generate/t_mstch_swift_generator.cc</code> and the templates are
located in <code>thrift/compiler/generate/templates/java/swift</code>. The specific
directory under the <code>templates</code> root under which the templates are located is
specified in the constructor to <code>t_mstch_generator</code>.</p><p>Creating a new generator then requires the following steps:</p><ol><li>Create the C++ file in which the driver will be contained.</li></ol><ul><li>Declare a new class inheriting from <code>t_mstch_generator</code> in this file.<ul><li>Include <code>&lt;thrift/compiler/generate/t_mstch_generator.h&gt;</code> to extend this
class.</li></ul></li><li>Register the new generator with the rest of the compiler.<ul><li><code>THRIFT_REGISTER_GENERATOR(generator_flag, &quot;Short name&quot;, &quot;Long name&quot;);</code></li></ul></li></ul><ol start="2"><li>Implement the <code>generate_program</code> function for your generator.</li><li>Write templates, iterating on the driver if necessary.</li></ol><ul><li>Template filenames must end in <code>.mustache</code>, and this extension will be
stripped when loading in the map of templates. This means that the canonical
name of a template stored in <code>FooBar.mustache</code> will be <code>FooBar</code> from within
the driver and other templates.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-templates">Using Templates<a class="hash-link" href="#using-templates" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="writing-the-driver">Writing the driver<a class="hash-link" href="#writing-the-driver" title="Direct link to heading">​</a></h3><p>There are several inherited functions which are useful when implementing
<code>generate_program</code> for a mstch generator.</p><ul><li><code>t_mstch_generator::dump</code><ul><li>Takes an element of the Thrift AST and converts it into a mstch context
node that can be provided to the renderer.</li></ul></li><li><code>t_mstch_generator::render</code><ul><li>Given the name of a template and a mstch context node, renders the template
and returns the results as a string.<ul><li>A template&#x27;s name is the same as its filename, but with the trailing
&quot;.mustache&quot; removed.</li></ul></li></ul></li><li><code>t_mstch_generator::write_output</code><ul><li>Given render output and a relative path, writes the output to disk, putting
the generated code in the proper absolute directory and recording that
the file was written.</li></ul></li><li><code>t_mstch_generator::get_option</code><ul><li>Returns the value associated with a particular
option key passed on the command line. This lets you change small behavior
details of your generator from the command line without needing a separate
generator.</li></ul></li></ul><p>A simple body for <code>generate_program</code> is as follows:</p><div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto context = this-&gt;dump(this-&gt;get_program());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto output = this-&gt;render(&quot;MyTemplate&quot;, context);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">this-&gt;write_output(&quot;my_output_file.txt&quot;, output);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="partial-templates">Partial Templates<a class="hash-link" href="#partial-templates" title="Direct link to heading">​</a></h3><p>From within a given template for a generator, other templates may be included
with the mstch inclusion syntax. If you have an existing template file named
&quot;Foo.mustache&quot;, it can be included by writing <code>{{&gt; Foo}}</code>. Templates
are permitted to recursively include themselves; however, care must be taken to
make sure that this terminates.</p><p>Note that the final newline, if present in a partial template file, is stripped
and not copied to the output. This allows template files to be properly
terminated with newlines without forcing a newline in the generated code. If a
template wants to emit an explicit newline at the end, simply add a blank line
or a commented line <code>{{! terminate with newline }}</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="context-types">Context types<a class="hash-link" href="#context-types" title="Direct link to heading">​</a></h3><p>mstch is an untyped system, and tags may have different behavior determined by
the structure of the context passed in from C++. For clarity of documentation,
I ascribe to each key in the default Thrift context a type which shows how it
can be used.</p><p>Note: Throughout the generators, I use <code>:</code> as a separator in mstch keys and <code>?</code>
to indicate mstch keys which are booleans. These characters have no special
meaning within mstch, and are only used as a convention adopted by the
generators.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="string"><code>string</code><a class="hash-link" href="#string" title="Direct link to heading">​</a></h4><p>Keys with type <code>string</code> represent leaves in the mstch context. At template
render time, they expand directly into a string with no mstch control flow.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">The name of this struct is {{struct:name}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="bool"><code>bool</code><a class="hash-link" href="#bool" title="Direct link to heading">​</a></h4><p>Bools are keys which do not expand to text, but only indicate some property
about the context.</p><div class="language-mustache codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mustache codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{#struct:plain?}}Rendered iff true{{/struct:plain?}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{^struct:plain?}}Rendered iff false{{/struct:plain?}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="list"><code>list&lt;?&gt;</code><a class="hash-link" href="#list" title="Direct link to heading">​</a></h4><p>Lists represent zero or more elements of some other type, and function similar
to for-each loops in other languages. The body of the loop will be expanded
once per element in the list, and, on each iteration, the context will be
extended using each member of the list. While expanding lists, two boolean keys
named <code>first?</code> and <code>last?</code> will be available, indicating whether the current
iteration is the first or the last iteration, respectively.</p><div class="language-mustache codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mustache codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{#program:structs}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {{#first?}}This is the first struct{{/first?}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  This struct has the name {{struct:name}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {{^last?}}This is not the last struct{{/last?}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{/program:structs}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also use the <code>^</code> syntax with lists, which will render the block if and
only if the list is empty.</p><div class="language-mustache codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mustache codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{^program:structs}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  There are no structs in this program</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{{/program:structs}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="context-structure">Context structure<a class="hash-link" href="#context-structure" title="Direct link to heading">​</a></h3><p>The following describes the default structure of the mstch contexts. These
defaults can be extended as described in a section below. For each
type there is a list of the keys available from within that type, the type of
each of those keys, and a short description of what the key means.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="program"><code>program</code><a class="hash-link" href="#program" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>program:name</code></td><td><code>string</code></td><td>Name of thrift program</td></tr><tr><td><code>program:path</code></td><td><code>string</code></td><td>Path to thrift source file</td></tr><tr><td><code>program:outPath</code></td><td><code>string</code></td><td>Path to output directory for generation</td></tr><tr><td><code>program:includePrefix</code></td><td><code>string</code></td><td>Path to include prefix for Thrift IDL</td></tr><tr><td><code>program:structs</code></td><td><code>list&lt;struct&gt;</code></td><td>Structs and Exceptions declared in this program</td></tr><tr><td><code>program:enums</code></td><td><code>list&lt;enum&gt;</code></td><td>Enums declared in this program</td></tr><tr><td><code>program:constants</code></td><td><code>list&lt;constant&gt;</code></td><td>Constants declared in this program</td></tr><tr><td><code>program:services</code></td><td><code>list&lt;service&gt;</code></td><td>Services declared in this program</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="struct"><code>struct</code><a class="hash-link" href="#struct" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>struct:name</code></td><td><code>string</code></td><td>Declared name of this struct</td></tr><tr><td><code>struct:fields</code></td><td><code>list&lt;field&gt;</code></td><td>Fields within this struct</td></tr><tr><td><code>struct:union?</code></td><td><code>bool</code></td><td>True iff declared as a union</td></tr><tr><td><code>struct:exception?</code></td><td><code>bool</code></td><td>True iff declared as an exception</td></tr><tr><td><code>struct:plain?</code></td><td><code>bool</code></td><td>True iff not a union or exception</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="field"><code>field</code><a class="hash-link" href="#field" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>field:name</code></td><td><code>string</code></td><td>Name of this field</td></tr><tr><td><code>field:key</code></td><td><code>string</code></td><td>The numeric key of this field</td></tr><tr><td><code>field:type</code></td><td><code>type</code></td><td>The declared type of this field</td></tr><tr><td><code>field:required?</code></td><td><code>bool</code></td><td>True iff this field is required</td></tr><tr><td><code>field:optional?</code></td><td><code>bool</code></td><td>True iff this field is optional</td></tr><tr><td><code>field:optInReqOut?</code></td><td><code>bool</code></td><td>True iff this field is optional in, required out</td></tr><tr><td><code>field:annotations</code></td><td><code>list&lt;annotation&gt;</code></td><td>List of annotations on this field</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enum"><code>enum</code><a class="hash-link" href="#enum" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>enum:name</code></td><td><code>string</code></td><td>Name of this enum</td></tr><tr><td><code>enum:values</code></td><td><code>list&lt;enum_value&gt;</code></td><td>Values of this enum</td></tr><tr><td><code>enum:annotations</code></td><td><code>list&lt;annotation&gt;</code></td><td>List of annotations declared on this enum</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enum_value"><code>enum_value</code><a class="hash-link" href="#enum_value" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>enum_value:name</code></td><td><code>string</code></td><td>Name of this variant of the enum</td></tr><tr><td><code>enum_value:value</code></td><td><code>string</code></td><td>Integer key for this enum variant</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="type"><code>type</code><a class="hash-link" href="#type" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>type:void?</code></td><td><code>bool</code></td><td>True iff this type is void</td></tr><tr><td><code>type:string?</code></td><td><code>bool</code></td><td>True iff this type is non-binary string</td></tr><tr><td><code>type:binary?</code></td><td><code>bool</code></td><td>True iff this type is binary string</td></tr><tr><td><code>type:bool?</code></td><td><code>bool</code></td><td>True iff this type is boolean</td></tr><tr><td><code>type:byte?</code></td><td><code>bool</code></td><td>True iff this type is byte</td></tr><tr><td><code>type:i16?</code></td><td><code>bool</code></td><td>True iff this type is i16 (16-bit signed int)</td></tr><tr><td><code>type:i32?</code></td><td><code>bool</code></td><td>True iff this type is i32 (32-bit signed int)</td></tr><tr><td><code>type:i64?</code></td><td><code>bool</code></td><td>True iff this type is i64 (64-bit signed int)</td></tr><tr><td><code>type:double?</code></td><td><code>bool</code></td><td>True iff this type is double</td></tr><tr><td><code>type:float?</code></td><td><code>bool</code></td><td>True iff this type is float</td></tr><tr><td><code>type:struct?</code></td><td><code>bool</code></td><td>True iff this type is a struct</td></tr><tr><td><code>type:struct</code></td><td><code>struct</code></td><td>Information about struct, if this is a struct</td></tr><tr><td><code>type:service?</code></td><td><code>bool</code></td><td>True iff this type is a service</td></tr><tr><td><code>type:service</code></td><td><code>struct</code></td><td>Information about struct, if this is a service</td></tr><tr><td><code>type:enum?</code></td><td><code>bool</code></td><td>True iff this type is an enum</td></tr><tr><td><code>type:enum</code></td><td><code>enum</code></td><td>Information about struct, if this is an  enum</td></tr><tr><td><code>type:list?</code></td><td><code>bool</code></td><td>True iff this type is a list</td></tr><tr><td><code>type:listElemType</code></td><td><code>type</code></td><td>Type of contained elements, if this is a list</td></tr><tr><td><code>type:stream?</code></td><td><code>bool</code></td><td>True iff this type is a stream</td></tr><tr><td><code>type:streamElemType</code></td><td><code>type</code></td><td>Type of contained elements, if this is a stream</td></tr><tr><td><code>type:set?</code></td><td><code>bool</code></td><td>True iff this type is a set</td></tr><tr><td><code>type:setElemType</code></td><td><code>type</code></td><td>Type of contained elements, if this is a set</td></tr><tr><td><code>type:map?</code></td><td><code>bool</code></td><td>True iff this type is a map</td></tr><tr><td><code>type:keyType</code></td><td><code>type</code></td><td>Type of keys, if this is a set</td></tr><tr><td><code>type:valueType</code></td><td><code>type</code></td><td>Type of values, if this is a set</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="service"><code>service</code><a class="hash-link" href="#service" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>service:name</code></td><td><code>string</code></td><td>Name of this service</td></tr><tr><td><code>service:annotations</code></td><td><code>list&lt;annotation&gt;</code></td><td>Annotations declared on this service</td></tr><tr><td><code>service:functions</code></td><td><code>list&lt;function&gt;</code></td><td>Functions defined on this service</td></tr><tr><td><code>service:extends?</code></td><td><code>bool</code></td><td>True iff this service extends another service</td></tr><tr><td><code>service:extends</code></td><td><code>service</code></td><td>The service this service extends, if one exists</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="function"><code>function</code><a class="hash-link" href="#function" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>function:name</code></td><td><code>string</code></td><td>Name of this function</td></tr><tr><td><code>function:oneway?</code></td><td><code>bool</code></td><td>True iff this function was declared oneway</td></tr><tr><td><code>function:returnType</code></td><td><code>type</code></td><td>Return type of this function</td></tr><tr><td><code>function:exceptions</code></td><td><code>list&lt;field&gt;</code></td><td>List of checked exceptions in this function</td></tr><tr><td><code>function:annotations</code></td><td><code>list&lt;annotation&gt;</code></td><td>List of annotations on this function</td></tr><tr><td><code>function:args</code></td><td><code>list&lt;field&gt;</code></td><td>List of arguments taken by this function</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="annotation"><code>annotation</code><a class="hash-link" href="#annotation" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>annotation:key</code></td><td><code>string</code></td><td>Key for this annotation</td></tr><tr><td><code>annotation:value</code></td><td><code>string</code></td><td>Value for this annotation</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="constant"><code>constant</code><a class="hash-link" href="#constant" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>constant:name</code></td><td><code>string</code></td><td>Name of this constant</td></tr><tr><td><code>constant:type</code></td><td><code>type</code></td><td>Type of this constant</td></tr><tr><td><code>constant:value</code></td><td><code>value</code></td><td>Defined value of this constant</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="value"><code>value</code><a class="hash-link" href="#value" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>value:double?</code></td><td><code>bool</code></td><td>True iff this value is a double</td></tr><tr><td><code>value:doubleValue</code></td><td><code>string</code></td><td>If this is a double, the double&#x27;s value</td></tr><tr><td><code>value:integer?</code></td><td><code>bool</code></td><td>True iff this value is an integer</td></tr><tr><td><code>value:integerValue?</code></td><td><code>string</code></td><td>If this is an integer, the integer&#x27;s value</td></tr><tr><td><code>value:nonzero?</code></td><td><code>bool</code></td><td>True iff this is a non-zero numeric constant</td></tr><tr><td><code>value:string?</code></td><td><code>bool</code></td><td>True iff this value is a string</td></tr><tr><td><code>value:stringValue</code></td><td><code>string</code></td><td>If this is a string, the string&#x27;s value</td></tr><tr><td><code>value:list?</code></td><td><code>bool</code></td><td>True iff this value is a list of other values</td></tr><tr><td><code>value:listElements</code></td><td><code>list&lt;value&gt;</code></td><td>The list of values in this list</td></tr><tr><td><code>value:map?</code></td><td><code>bool</code></td><td>True iff this value is a map</td></tr><tr><td><code>value:mapElements</code></td><td><code>list&lt;mapElement&gt;</code></td><td>The elements in this map of values</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mapelement"><code>mapElement</code><a class="hash-link" href="#mapelement" title="Direct link to heading">​</a></h4><table><thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>element:key</code></td><td><code>value</code></td><td>The key of this element of a map</td></tr><tr><td><code>element:value</code></td><td><code>value</code></td><td>The value of this element of a map</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="extending-context-maps">Extending Context Maps<a class="hash-link" href="#extending-context-maps" title="Direct link to heading">​</a></h3><p>In some cases, mstch templates are not powerful enough to perform desired
operations and the default context described above does not contain enough
information to implement a feature for a given generator. If you would prefer
to sort the fields of a struct alphabetically, or escape the names of structs
in some way, that would not be possible using the default context alone. To
solve this, the generators support extending the default context with custom
generator-defined elements to overcome these limitations.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="an-example-escaping">An Example: Escaping<a class="hash-link" href="#an-example-escaping" title="Direct link to heading">​</a></h4><p>Suppose the generated code for a given language needs to escape the name of each
struct before emitting. To accomplish this, we will override
<code>t_mstch_generator::extend_struct</code> in our subclass.</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mstch</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token plain">map </span><span class="token function" style="color:rgb(130, 170, 255)">extend_struct</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> t_struct</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> strct</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">override</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;escapedName&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">my_escaping_function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">strct</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">get_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where <code>my_escaping_function</code> is some function that performs the desired
escaping. From within templates now, as long as a struct is currently in scope,
<code>{{struct:escapedName}}</code> will refer to the escaped name as defined above, as the
builtin <code>dump</code> functions are aware of the <code>extend_*</code> functions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-new-generator">Using the new generator<a class="hash-link" href="#using-the-new-generator" title="Direct link to heading">​</a></h2><p>To invoke a mstch generator, run the following command:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">thrift --gen $MY_GENERATOR -o $OUT_DIR $THRIFT_SRC</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where <code>MY_GENERATOR</code> is the name of the generator as specified in the C++ driver,
<code>OUT_DIR</code> is the desired output directory, and <code>THRIFT_SRC</code> is the Thrift IDL
source file.</p><p>Options can be specified as part of the string passed to <code>--gen</code>, for example:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">thrift --gen mstch_swift:option=value -o $PWD $PWD/test.thrift</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/fbthrift/blob/main/thrift/website/../doc/internals/mstch.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/internals/header-format"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Header format for the THeader.h</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/internals/protocol-structure"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Thrift Protocol Structure</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#thrift-generators" class="table-of-contents__link toc-highlight">Thrift Generators</a></li><li><a href="#creating-a-generator" class="table-of-contents__link toc-highlight">Creating a generator</a></li><li><a href="#using-templates" class="table-of-contents__link toc-highlight">Using Templates</a><ul><li><a href="#writing-the-driver" class="table-of-contents__link toc-highlight">Writing the driver</a></li><li><a href="#partial-templates" class="table-of-contents__link toc-highlight">Partial Templates</a></li><li><a href="#context-types" class="table-of-contents__link toc-highlight">Context types</a></li><li><a href="#context-structure" class="table-of-contents__link toc-highlight">Context structure</a></li><li><a href="#extending-context-maps" class="table-of-contents__link toc-highlight">Extending Context Maps</a></li></ul></li><li><a href="#using-the-new-generator" class="table-of-contents__link toc-highlight">Using the new generator</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/thrift" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://engineering.fb.com/2014/02/20/open-source/under-the-hood-building-and-open-sourcing-fbthrift/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/fbthrift" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2022 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1abcbc59.js"></script>
<script src="/assets/js/main.b3203846.js"></script>
</body>
</html>